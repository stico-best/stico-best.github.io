<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="数据挖掘与分析部分模块的实例及原理应用">
<meta property="og:type" content="article">
<meta property="og:title" content="Python数据分析与挖掘">
<meta property="og:url" content="http://example.com/posts/c1c7733e.html">
<meta property="og:site_name" content="学习 &amp; 工作">
<meta property="og:description" content="数据挖掘与分析部分模块的实例及原理应用">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/posts/c1c7733e/1.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/2.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/3.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/4.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/5.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/6.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/7.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/8.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/9.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/10.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/11.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/12.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/13.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/14.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/15.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/16.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/17.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/GMM.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/%E8%88%AA%E7%A9%BA.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/bit1.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/bit2.png">
<meta property="og:image" content="http://example.com/posts/c1c7733e/bit3.png">
<meta property="article:published_time" content="2023-06-15T08:08:58.000Z">
<meta property="article:modified_time" content="2023-06-19T08:14:25.695Z">
<meta property="article:author" content="STico">
<meta property="article:tag" content="6">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/posts/c1c7733e/1.png">

<link rel="canonical" href="http://example.com/posts/c1c7733e.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Python数据分析与挖掘 | 学习 & 工作</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">学习 & 工作</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/c1c7733e.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="STico">
      <meta itemprop="description" content="永远相信美好的事情即将发生">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习 & 工作">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Python数据分析与挖掘
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-15 16:08:58" itemprop="dateCreated datePublished" datetime="2023-06-15T16:08:58+08:00">2023-06-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-19 16:14:25" itemprop="dateModified" datetime="2023-06-19T16:14:25+08:00">2023-06-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>25k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>23 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>数据挖掘与分析部分模块的实例及原理应用</strong></p>
<span id="more"></span>

<h1 id="Numpy学习"><a href="#Numpy学习" class="headerlink" title="Numpy学习"></a>Numpy学习</h1><table>
<thead>
<tr>
<th align="center">姓名</th>
<th align="center">语文</th>
<th align="center">英语</th>
<th align="center">数学</th>
</tr>
</thead>
<tbody><tr>
<td align="center">张飞</td>
<td align="center">66</td>
<td align="center">65</td>
<td align="center">30</td>
</tr>
<tr>
<td align="center">关羽</td>
<td align="center">95</td>
<td align="center">85</td>
<td align="center">98</td>
</tr>
<tr>
<td align="center">赵云</td>
<td align="center">93</td>
<td align="center">92</td>
<td align="center">96</td>
</tr>
<tr>
<td align="center">黄忠</td>
<td align="center">90</td>
<td align="center">88</td>
<td align="center">77</td>
</tr>
<tr>
<td align="center">典韦</td>
<td align="center">80</td>
<td align="center">90</td>
<td align="center">90</td>
</tr>
</tbody></table>
<h2 id="题目具体要求"><a href="#题目具体要求" class="headerlink" title="题目具体要求"></a>题目具体要求</h2><p>1、使用 Numpy 统计团队中成员的语文、英语、数学的平均成绩、最小成绩、最大成绩、方差、标准差。</p>
<p>2、把这些人的总成绩排序，得出名次进行成绩输出。</p>
<h2 id="Numpy基本原理"><a href="#Numpy基本原理" class="headerlink" title="Numpy基本原理"></a><strong>Numpy基本原理</strong></h2><p>Numpy 是 Python 语言的一个第三方库，其支持大量高维度<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%95%B0%E7%BB%84&spm=1001.2101.3001.7020">数组</a>与矩阵运算。此外，NumPy 也针对数组运算提供大量的数学函数。Numpy 中定义的最重要的对象是称为 <code>ndarray</code> 的 N 维数组类型。 它描述相同类型的元素<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%9B%86%E5%90%88&spm=1001.2101.3001.7020">集合</a>。 可以使用基于零的索引访问集合中的项目。</p>
<h2 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">persontype = np.dtype(&#123;<span class="string">&#x27;names&#x27;</span>: [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;chinese&#x27;</span>, <span class="string">&#x27;math&#x27;</span>, <span class="string">&#x27;english&#x27;</span>, <span class="string">&#x27;total&#x27;</span>], <span class="string">&#x27;formats&#x27;</span>: [<span class="string">&#x27;S32&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;i&#x27;</span>]&#125;)</span><br><span class="line">peoples = np.array([(<span class="string">&quot;zhang fei&quot;</span>, <span class="number">18</span>, <span class="number">66</span>, <span class="number">30</span>, <span class="number">65</span>, <span class="number">0</span>), (<span class="string">&quot;guan yu&quot;</span>, <span class="number">19</span>, <span class="number">95</span>, <span class="number">98</span>, <span class="number">85</span>, <span class="number">0</span>), (<span class="string">&quot;zhao yun&quot;</span>, <span class="number">20</span>, <span class="number">93</span>, <span class="number">96</span>, <span class="number">92</span>, <span class="number">0</span>), (<span class="string">&quot;huang zhong&quot;</span>, <span class="number">21</span>, <span class="number">90</span>, <span class="number">77</span>, <span class="number">88</span>, <span class="number">0</span>)], dtype=persontype)</span><br><span class="line"></span><br><span class="line">ages = peoples[:][<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">chineses = peoples[:][<span class="string">&#x27;chinese&#x27;</span>]</span><br><span class="line">maths = peoples[:][<span class="string">&#x27;math&#x27;</span>]</span><br><span class="line">englishs = peoples[:][<span class="string">&#x27;english&#x27;</span>]</span><br><span class="line">total = peoples[:][<span class="string">&#x27;total&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;各项平均值&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;年龄：&quot;</span>, np.mean(ages))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;语文：&quot;</span>, np.mean(chineses))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数学：&quot;</span>, np.mean(maths))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;英语：&quot;</span>, np.mean(englishs))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;各项最大值&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;年龄：&quot;</span>, np.amax(ages))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;语文：&quot;</span>, np.amax(chineses))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数学：&quot;</span>, np.amax(maths))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;英语：&quot;</span>, np.amax(englishs))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;各项最小值&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;年龄：&quot;</span>, np.amin(ages))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;语文：&quot;</span>, np.amin(chineses))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数学：&quot;</span>, np.amin(maths))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;英语：&quot;</span>, np.amin(englishs))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;各项标准差&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;年龄：&quot;</span>, np.std(ages))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;语文：&quot;</span>, np.std(chineses))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数学：&quot;</span>, np.std(maths))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;英语：&quot;</span>, np.std(englishs))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;各项方差&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;年龄：&quot;</span>, np.var(ages))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;语文：&quot;</span>, np.var(chineses))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数学：&quot;</span>, np.var(maths))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;英语：&quot;</span>, np.var(englishs))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;总成绩排序&quot;</span>)</span><br><span class="line">peoples[:][<span class="string">&#x27;total&#x27;</span>] = chineses + maths + englishs</span><br><span class="line">rank = <span class="built_in">sorted</span>(peoples, key=<span class="keyword">lambda</span> t: t[<span class="number">4</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> rank:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>

<h2 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">各项平均值</span><br><span class="line">年龄： 19.5</span><br><span class="line">语文： 86.0</span><br><span class="line">数学： 75.25</span><br><span class="line">英语： 82.5</span><br><span class="line"></span><br><span class="line">各项最大值</span><br><span class="line">年龄： 21</span><br><span class="line">语文： 95</span><br><span class="line">数学： 98</span><br><span class="line">英语： 92</span><br><span class="line"></span><br><span class="line">各项最小值</span><br><span class="line">年龄： 18</span><br><span class="line">语文： 66</span><br><span class="line">数学： 30</span><br><span class="line">英语： 65</span><br><span class="line"></span><br><span class="line">各项标准差</span><br><span class="line">年龄： 1.118033988749895</span><br><span class="line">语文： 11.683321445547923</span><br><span class="line">数学： 27.380421837510102</span><br><span class="line">英语： 10.404326023342406</span><br><span class="line"></span><br><span class="line">各项方差</span><br><span class="line">年龄： 1.25</span><br><span class="line">语文： 136.5</span><br><span class="line">数学： 749.6875</span><br><span class="line">英语： 108.25</span><br><span class="line"></span><br><span class="line">总成绩排序</span><br><span class="line">(b&#x27;zhao yun&#x27;, 20, 93, 96, 92, 281)</span><br><span class="line">(b&#x27;huang zhong&#x27;, 21, 90, 77, 88, 255)</span><br><span class="line">(b&#x27;guan yu&#x27;, 19, 95, 98, 85, 278)</span><br><span class="line">(b&#x27;zhang fei&#x27;, 18, 66, 30, 65, 161)</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Pandas学习"><a href="#Pandas学习" class="headerlink" title="Pandas学习"></a>Pandas学习</h1><p>学习数据结构：Series 和 DataFrame</p>
<p>Series 是个定长的字典序列。说是定长是因为在存储的时候，相当于两个 ndarray，这也是和字典结构最大的不同。因为在字典的结构里，元素的个数是不固定的。</p>
<p>Series 有两个基本属性：index 和 values。在 Series 结构中，index 默认是 0,1,2,……递增的整数序列，当然也可以自己来指定索引，比如 index&#x3D;[‘a’, ‘b’, ‘c’, ‘d’]。</p>
<p>DataFrame 类型数据结构类似数据库表，它包括了行索引和列索引，可以将 DataFrame 看成是由相同索引的 Series 组成的字典类型。</p>
<p>(二)  Pandas数据清洗</p>
<p>1.删除 DataFrame 中的不必要的列或行；</p>
<p>2.重命名列名 columns，让列表名更容易识别；</p>
<p>3.去重复的值数据采集可能存在重复的行；</p>
<p>4.格式问题；</p>
<p>5.查找空值。</p>
<hr>
<h1 id="Kaggle竞赛-Titanic乘客生存预测"><a href="#Kaggle竞赛-Titanic乘客生存预测" class="headerlink" title="Kaggle竞赛-Titanic乘客生存预测"></a>Kaggle竞赛-Titanic乘客生存预测</h1><p>决策树与AdaBoost实验</p>
<h2 id="目标任务"><a href="#目标任务" class="headerlink" title="目标任务"></a><strong>目标任务</strong></h2><p>（1） 学习决策树、AdaBoost的原理，特性；</p>
<p>（2） 学习使用Python编写决策树和AdaBoost分类器；</p>
<p>（3） 学习使用sklearn训练决策树和AdaBoost，熟悉数据挖掘的一般流程.</p>
<hr>
<h2 id="实验数据"><a href="#实验数据" class="headerlink" title="实验数据"></a><strong>实验数据</strong></h2><p>Kaggle数据挖掘竞赛平台之Titanic 乘客生存预测。问题描述：泰坦尼克海难是著名的十大灾难之一，究竟多少人遇难，各方统计的结果不一。Kaggle数据挖掘竞赛平台的数据集数据集格式为 csv，一共有两个文件：train.csv 是训练数据集，包含特征信息和存活与否的标签；test.csv: 测试数据集，只包含特征信息。</p>
<p>在训练集中，包括了以下字段，它们具体为：</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">PassengerId</td>
<td>乘客编号</td>
</tr>
<tr>
<td align="left">Survived</td>
<td>是否幸存</td>
</tr>
<tr>
<td align="left">Pclass</td>
<td>船票等级</td>
</tr>
<tr>
<td align="left">Name</td>
<td>乘客姓名</td>
</tr>
<tr>
<td align="left">Sex</td>
<td>乘客性别</td>
</tr>
<tr>
<td align="left">SibSp</td>
<td>亲戚数量（兄妹、配偶数）</td>
</tr>
<tr>
<td align="left">Parch</td>
<td>亲戚数量（父母、子女数）</td>
</tr>
<tr>
<td align="left">Ticket</td>
<td>船票号码</td>
</tr>
<tr>
<td align="left">Fare</td>
<td>船票价格</td>
</tr>
<tr>
<td align="left">Cabin</td>
<td>船舱</td>
</tr>
<tr>
<td align="left">Embarked</td>
<td>登陆港口</td>
</tr>
</tbody></table>
<hr>
<h2 id="生存预测的关键流程"><a href="#生存预测的关键流程" class="headerlink" title="生存预测的关键流程"></a><strong>生存预测的关键流程</strong></h2><p>要对训练集中乘客的生存进行预测，这个过程可以划分为两个重要的阶段：</p>
<p>准备阶段：首先需要对训练集、测试集的数据进行探索，分析数据质量，并对数据进行清洗，然后通过特征选择对数据进行降维，方便后续分类运算；</p>
<p>分类阶段：首先通过训练集的特征矩阵、分类结果得到分类器，然后将分类器应用于测试集。然后对分类器的准确性进行分析，并对模型进行可视化。</p>
<h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a><strong>实验过程</strong></h2><h3 id="实验导入模块"><a href="#实验导入模块" class="headerlink" title="实验导入模块"></a>实验导入模块</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> AdaBoostClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="数据探索"><a href="#数据探索" class="headerlink" title="数据探索"></a><strong>数据探索</strong></h3><ul>
<li><p>info():了解数据表的基本情况，包括行数、列数、每列的数据类型、数据完整度；</p>
</li>
<li><p>describe():了解数据表的统计情况，包括总数、平均值、标准差、最小值、最大值等；</p>
</li>
<li><p>describe(include&#x3D;[‘O’]):查看字符串类型（非数字）的整体情况；</p>
</li>
<li><p>head():查看前几行数据（默认是前 5 行）；</p>
</li>
<li><p>tail():查看后几行数据（默认是最后 5 行）。</p>
</li>
</ul>
<p>具体代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 数据加载</span></span><br><span class="line">train_data = pd.read_csv(<span class="string">&#x27;Titanic.train.csv&#x27;</span>)</span><br><span class="line">test_data = pd.read_csv(<span class="string">&#x27;Titanic.test.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据探索</span></span><br><span class="line"><span class="built_in">print</span>(train_data.info())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(train_data.describe())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(train_data.describe(include=[<span class="string">&#x27;O&#x27;</span>]))  <span class="comment"># include后面是大写的O字母</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<p>数据读取结果：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">class</span> &#x27;<span class="attr">pandas.core.frame.DataFrame</span>&#x27;&gt;</span></span></span><br><span class="line">RangeIndex: 891 entries, 0 to 890</span><br><span class="line">Data columns (total 12 columns):</span><br><span class="line"> #   Column       Non-Null Count  Dtype  </span><br><span class="line">---  ------       --------------  -----  </span><br><span class="line"> 0   PassengerId  891 non-null    int64  </span><br><span class="line"> 1   Survived     891 non-null    int64  </span><br><span class="line"> 2   Pclass       891 non-null    int64  </span><br><span class="line"> 3   Name         891 non-null    object </span><br><span class="line"> 4   Sex          891 non-null    object </span><br><span class="line"> 5   Age          714 non-null    float64</span><br><span class="line"> 6   SibSp        891 non-null    int64  </span><br><span class="line"> 7   Parch        891 non-null    int64  </span><br><span class="line"> 8   Ticket       891 non-null    object </span><br><span class="line"> 9   Fare         891 non-null    float64</span><br><span class="line"> 10  Cabin        204 non-null    object </span><br><span class="line"> 11  Embarked     891 non-null    object </span><br><span class="line">dtypes: float64(2), int64(5), object(5)</span><br><span class="line">memory usage: 83.7+ KB</span><br><span class="line">None</span><br></pre></td></tr></table></figure>



<h3 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a><strong>数据清洗</strong></h3><p>通过数据探索，我们发现 Age、Fare 和 Cabin 这三个字段的数据有所缺失。其中 Age 为年龄字段，是数值型，我们可以通过平均值进行补齐；Fare 为船票价格，是数值型，我们也可以通过其他人购买船票的平均值进行补齐。具体实现的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用平均年龄来填充年龄中的nan值</span></span><br><span class="line">train_data[<span class="string">&#x27;Age&#x27;</span>].fillna(train_data[<span class="string">&#x27;Age&#x27;</span>].mean(), inplace=<span class="literal">True</span>)</span><br><span class="line">test_data[<span class="string">&#x27;Age&#x27;</span>].fillna(test_data[<span class="string">&#x27;Age&#x27;</span>].mean(), inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用票价的均值填充票价中的nan值</span></span><br><span class="line">train_data[<span class="string">&#x27;Fare&#x27;</span>].fillna(train_data[<span class="string">&#x27;Fare&#x27;</span>].mean(), inplace=<span class="literal">True</span>)</span><br><span class="line">test_data[<span class="string">&#x27;Fare&#x27;</span>].fillna(test_data[<span class="string">&#x27;Fare&#x27;</span>].mean(), inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(train_data[<span class="string">&#x27;Embarked&#x27;</span>].value_counts())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用登录最多的港口来填充登录港口的nan值</span></span><br><span class="line">train_data[<span class="string">&#x27;Embarked&#x27;</span>].fillna(<span class="string">&#x27;S&#x27;</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">test_data[<span class="string">&#x27;Embarked&#x27;</span>].fillna(<span class="string">&#x27;S&#x27;</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h3 id="特征选择"><a href="#特征选择" class="headerlink" title="特征选择"></a><strong>特征选择</strong></h3><p>特征选择是分类器的关键。特征选择不同，得到的分类器也不同。那么该选择哪些特征做生存的预测呢？</p>
<p>通过数据探索发现，PassengerId 为乘客编号，对分类没有作用，可以放弃；Name 为乘客姓名，对分类没有作用，可以放弃；Cabin 字段缺失值太多，可以放弃；Ticket 字段为船票号码，杂乱无章且无规律，可以放弃。其余的字段包括：Pclass、Sex、Age、SibSp、Parch 和 Fare，这些属性分别表示了乘客的船票等级、性别、年龄、亲戚数量以及船票价格，可能会和乘客的生存预测分类有关系。具体是什么关系，我们可以交给分类器来处理。因此先将 Pclass、Sex、Age 等这些其余的字段作特征，放到特征向量 features 里。</p>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模块3：特征选择</span></span><br><span class="line">features = [<span class="string">&#x27;Pclass&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>, <span class="string">&#x27;SibSp&#x27;</span>, <span class="string">&#x27;Parch&#x27;</span>, <span class="string">&#x27;Fare&#x27;</span>, <span class="string">&#x27;Embarked&#x27;</span>]</span><br><span class="line">train_features = train_data[features]</span><br><span class="line">train_labels = train_data[<span class="string">&#x27;Survived&#x27;</span>]</span><br><span class="line">test_features = test_data[features]</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction <span class="keyword">import</span> DictVectorizer</span><br><span class="line">dvec = DictVectorizer(sparse=<span class="literal">False</span>)</span><br><span class="line">train_features = dvec.fit_transform(train_features.to_dict(orient=<span class="string">&#x27;record&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(dvec.feature_names_)</span><br></pre></td></tr></table></figure>

<p>数据读取结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">S    644</span><br><span class="line">C    168</span><br><span class="line">Q     77</span><br><span class="line">U      2</span><br><span class="line">Name: Embarked, dtype: int64</span><br></pre></td></tr></table></figure>



<h3 id="分类模型及模型的评价"><a href="#分类模型及模型的评价" class="headerlink" title="分类模型及模型的评价"></a><strong>分类模型及模型的评价</strong></h3><p>1） 使用 sklearn 中的决策树模型。使用 ID3 算法使用DecisionTreeClassifier 时，设置 criterion&#x3D;‘entropy’，然后使用 fit 进行训练，将特征值矩阵和分类标识结果作为参数传入，得到决策树分类器。</p>
<p>2） 使用 sklearn 中的集成学习模型Adaboost()</p>
<p>3） 采用 K 折交叉验证准确率。sklearn 的 model_selection 模型选择中提供了 cross_val_score 函数。</p>
<p>Ø K 折交叉验证的原理：</p>
<p>拿出大部分样本进行训练，少量的用于分类器的验证。K 折交叉验证，就是做 K 次交叉验证，每次选取 K 分之一的数据作为验证，其余作为训练。轮流 K 次，取平均值。</p>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 决策树弱分类器</span></span><br><span class="line">dt_stump = DecisionTreeClassifier(max_depth=<span class="number">7</span>, min_samples_leaf=<span class="number">5</span>)</span><br><span class="line">dt_stump.fit(train_features, train_labels)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">u&#x27;决策树弱分类器准确率为 %.4lf&#x27;</span> % np.mean(cross_val_score(dt_stump, train_features, train_labels, cv=<span class="number">10</span>)))</span><br><span class="line"><span class="comment"># 决策树分类器</span></span><br><span class="line">dt = DecisionTreeClassifier()</span><br><span class="line">dt.fit(train_features, train_labels)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">u&#x27;决策树分类器准确率为 %.4lf&#x27;</span> % np.mean(cross_val_score(dt, train_features, train_labels, cv=<span class="number">10</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># AdaBoost分类器</span></span><br><span class="line">ada = AdaBoostClassifier()</span><br><span class="line">ada.fit(train_features, train_labels)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">u&#x27;AdaBoost 分类器准确率为 %.4lf&#x27;</span> %</span><br><span class="line">np.mean(cross_val_score(ada, train_features, train_labels, cv=<span class="number">15</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># XGBoost分类器</span></span><br><span class="line">xgb = xgb.XGBClassifier(max_depth=<span class="number">8</span>, min_child_weight=<span class="number">3</span>)</span><br><span class="line">xgb.fit(train_features, train_labels)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">u&#x27;XGBoost 分类器准确率为 %.4lf&#x27;</span> %</span><br><span class="line">np.mean(cross_val_score(ada, train_features, train_labels, cv=<span class="number">15</span>)))</span><br></pre></td></tr></table></figure>

<h3 id="各个分类器准确率"><a href="#各个分类器准确率" class="headerlink" title="各个分类器准确率"></a>各个分类器准确率</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">决策树弱分类器准确率为 0.8228</span><br><span class="line">决策树分类器准确率为 0.7778</span><br><span class="line">AdaBoost 分类器准确率为 0.8183</span><br><span class="line">XGBoost 分类器准确率为 0.8183</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="银行客户违约信用分析"><a href="#银行客户违约信用分析" class="headerlink" title="银行客户违约信用分析"></a>银行客户违约信用分析</h1><p>对银行客户基本信息数据集进行分析，提取不同信息进行特征分析和预测，通过多种分类器算法预测客户违约行为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction <span class="keyword">import</span> DictVectorizer</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> AdaBoostClassifier</span><br><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> MultinomialNB<span class="comment">#多项式朴素贝叶斯分类器</span></span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> LinearSVC</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> BernoulliNB</span><br></pre></td></tr></table></figure>

<h2 id="数据集读取转换csv文件预处理"><a href="#数据集读取转换csv文件预处理" class="headerlink" title="数据集读取转换csv文件预处理"></a>数据集读取转换csv文件预处理</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># datafile = &#x27;data.xls&#x27;</span></span><br><span class="line">resultfile = <span class="string">&#x27;data.csv&#x27;</span></span><br><span class="line">data = pd.read_excel(<span class="string">&#x27;data.xls&#x27;</span>)</span><br><span class="line">data.to_csv(resultfile)</span><br><span class="line"><span class="comment">## excel转成csv表头中文乱码</span></span><br></pre></td></tr></table></figure>

<h2 id="数据探索-1"><a href="#数据探索-1" class="headerlink" title="数据探索"></a>数据探索</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">datafile = <span class="string">&#x27;data.csv&#x27;</span></span><br><span class="line">data = pd.read_csv(datafile)</span><br><span class="line"><span class="built_in">print</span>(data.info())</span><br><span class="line">data1 = data.describe()</span><br><span class="line">data1.to_excel(<span class="string">&#x27;data_dexcribe.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>

<img src="/posts/c1c7733e/1.png" class="">

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">weiyue = pd.value_counts(data[<span class="string">&#x27;违约&#x27;</span>])[<span class="number">1</span>]</span><br><span class="line">not_weiyue = pd.value_counts(data[<span class="string">&#x27;违约&#x27;</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图</span></span><br><span class="line">fig = plt.figure(figsize = (<span class="number">8</span>, <span class="number">5</span>))  <span class="comment"># 设置画布大小</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;KaiTi&#x27;</span>]</span><br><span class="line">plt.bar(x=<span class="built_in">range</span>(<span class="number">2</span>), height=[weiyue, not_weiyue,], width=<span class="number">0.4</span>, alpha=<span class="number">0.8</span>, color=<span class="string">&#x27;skyblue&#x27;</span>)</span><br><span class="line">plt.xticks([index <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)], [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;0&#x27;</span>])</span><br><span class="line">plt.xlabel(<span class="string">&#x27;是否违约&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;客户人数&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;客户是否违约柱状图&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line">plt.close()</span><br><span class="line"><span class="comment">## 输出可见违约：未违约大概2:5</span></span><br></pre></td></tr></table></figure>

<img src="/posts/c1c7733e/2.png" class="">

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制 是否违约客户 与 年龄 的分布</span></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="comment">## 提取年龄</span></span><br><span class="line">age = data[<span class="string">&#x27;年龄&#x27;</span>].dropna()</span><br><span class="line">age = age.astype(<span class="string">&#x27;int64&#x27;</span>)</span><br><span class="line"><span class="comment">## 绘制客户年龄分布箱型图</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">fig, axes = plt.subplots(<span class="number">1</span>, <span class="number">3</span>, figsize=(<span class="number">10</span>, <span class="number">5</span>))</span><br><span class="line">sns.distplot(data[<span class="string">&quot;年龄&quot;</span>], ax = axes[<span class="number">0</span>], axlabel=<span class="string">&#x27;所有客户年龄分布&#x27;</span>)</span><br><span class="line">sns.distplot(data.loc[data[<span class="string">&quot;违约&quot;</span>]==<span class="number">0</span>][<span class="string">&quot;年龄&quot;</span>], ax = axes[<span class="number">1</span>], axlabel = <span class="string">&#x27;非违约客户年龄分布&#x27;</span>)</span><br><span class="line">sns.distplot(data.loc[data[<span class="string">&quot;违约&quot;</span>]==<span class="number">1</span>][<span class="string">&quot;年龄&quot;</span>], ax = axes[<span class="number">2</span>], axlabel = <span class="string">&#x27;违约客户年龄分布&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line">plt.close()</span><br></pre></td></tr></table></figure>

<img src="/posts/c1c7733e/3.png" class="">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 客户年龄中存在300岁，需要数据清洗删除异常值，用年龄均值填充</span></span><br><span class="line"><span class="comment"># plt.title(&#x27;客户是否违约柱状图&#x27;)</span></span><br><span class="line"><span class="comment"># plt.show()</span></span><br><span class="line"><span class="comment"># plt.close()</span></span><br><span class="line"><span class="comment"># 均值填充年龄</span></span><br><span class="line">data[<span class="string">&#x27;年龄&#x27;</span>].fillna(data[<span class="string">&#x27;年龄&#x27;</span>].mean(), inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 删除年龄大于80的数据</span></span><br><span class="line">data.drop(data[(data[<span class="string">&#x27;年龄&#x27;</span>] &gt; <span class="number">80</span>)].index.tolist(), inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&quot;年龄&quot;</span>].describe())</span><br><span class="line"><span class="comment"># 将性别数据分别用female=1，male=0表示</span></span><br><span class="line">data.loc[data[<span class="string">&quot;性别&quot;</span>] == <span class="string">&quot;male&quot;</span>, <span class="string">&quot;性别&quot;</span>] = <span class="number">0</span></span><br><span class="line">data.loc[data[<span class="string">&quot;性别&quot;</span>] == <span class="string">&quot;female&quot;</span>, <span class="string">&quot;性别&quot;</span>] = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>性别特性处理：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">count    699.000000</span><br><span class="line">mean      34.863308</span><br><span class="line">std        7.967906</span><br><span class="line">min       20.000000</span><br><span class="line">25%       29.000000</span><br><span class="line">50%       34.000000</span><br><span class="line">75%       40.000000</span><br><span class="line">max       56.000000</span><br><span class="line">Name: 年龄, dtype: float64</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算相关性矩阵</span></span><br><span class="line">data_corr = data</span><br><span class="line">dt_corr = data_corr.corr(method = <span class="string">&#x27;pearson&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;相关性矩阵为：\n&#x27;</span>, dt_corr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制热力图</span></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">plt.subplots(figsize=(<span class="number">10</span>, <span class="number">10</span>))</span><br><span class="line">sns.heatmap(dt_corr, annot=<span class="literal">True</span>, vmax=<span class="number">1</span>, square=<span class="literal">True</span>, cmap=<span class="string">&#x27;Blues&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line">plt.close()</span><br></pre></td></tr></table></figure>

<img src="/posts/c1c7733e/4.png" class="">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_extraction <span class="keyword">import</span> DictVectorizer</span><br><span class="line"><span class="comment"># 通过分析选择合适的特征用于预测</span></span><br><span class="line">features = [<span class="string">&#x27;年龄&#x27;</span>, <span class="string">&#x27;教育&#x27;</span>, <span class="string">&#x27;工龄&#x27;</span>, <span class="string">&#x27;地址&#x27;</span>, <span class="string">&#x27;负债率&#x27;</span>, <span class="string">&#x27;信用卡负债&#x27;</span>, <span class="string">&#x27;收入&#x27;</span>]</span><br><span class="line">features_train = data[features]</span><br><span class="line">train_label = data[<span class="string">&#x27;违约&#x27;</span>]</span><br><span class="line">dev = DictVectorizer(sparse=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 转化成字典型</span></span><br><span class="line">features_train = dev.fit_transform(features_train.to_dict(orient=<span class="string">&#x27;record&#x27;</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(features_train,train_label,test_size=<span class="number">0.3</span>, random_state=<span class="number">23</span>,shuffle=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neural_network <span class="keyword">import</span> MLPClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix, classification_report</span><br><span class="line"><span class="keyword">import</span> sklearn.metrics <span class="keyword">as</span> metrics</span><br><span class="line"><span class="comment">#import sklearn.metrics.roc</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Confusion_matrix</span>(<span class="params">model</span>):</span><br><span class="line">    <span class="built_in">print</span>(confusion_matrix(y_test, model.predict(X_test)))  <span class="comment"># 混淆矩阵</span></span><br><span class="line">    <span class="built_in">print</span>(classification_report(y_test, model.predict(X_test)))  <span class="comment"># 分类报告</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment"># 混淆矩阵可视化</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot_confusion_matrix</span>(<span class="params">cm, classes, normalize = <span class="literal">False</span>, title = <span class="string">&#x27;Confusion matrix&quot;&#x27;</span>, cmap = plt.cm.Blues</span>) :</span><br><span class="line">    plt.figure()</span><br><span class="line">    plt.imshow(cm, interpolation = <span class="string">&#x27;nearest&#x27;</span>, cmap = cmap)</span><br><span class="line">    plt.title(title)</span><br><span class="line">    plt.colorbar()</span><br><span class="line">    tick_marks = np.arange(<span class="built_in">len</span>(classes))</span><br><span class="line">    plt.xticks(tick_marks, classes, rotation = <span class="number">0</span>)</span><br><span class="line">    plt.yticks(tick_marks, classes)</span><br><span class="line"> </span><br><span class="line">    thresh = cm.<span class="built_in">max</span>() / <span class="number">2.</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(cm.shape[<span class="number">0</span>]), <span class="built_in">range</span>(cm.shape[<span class="number">1</span>])) :</span><br><span class="line">        plt.text(j, i, cm[i, j],</span><br><span class="line">                 horizontalalignment = <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">                 color = <span class="string">&#x27;white&#x27;</span> <span class="keyword">if</span> cm[i, j] &gt; thresh <span class="keyword">else</span> <span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    plt.tight_layout()</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;True label&#x27;</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;Predicted label&#x27;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="不同分类器处理结果呈现"><a href="#不同分类器处理结果呈现" class="headerlink" title="不同分类器处理结果呈现"></a>不同分类器处理结果呈现</h2><h3 id="决策树与决策树弱分类器"><a href="#决策树与决策树弱分类器" class="headerlink" title="决策树与决策树弱分类器"></a>决策树与决策树弱分类器</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#决策树分类器</span></span><br><span class="line">dt = DecisionTreeClassifier(max_depth=<span class="number">3</span>,min_samples_leaf=<span class="number">1</span>)</span><br><span class="line">dt.fit(features_train, train_label)</span><br><span class="line"></span><br><span class="line"><span class="comment">#决策树弱分类器</span></span><br><span class="line">dt_stump =DecisionTreeClassifier()</span><br><span class="line">dt_stump.fit(features_train,train_label)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 决策树分类器</span></span><br><span class="line">dt.fit(X_train, y_train)</span><br><span class="line">predict_y = dt.predict(X_test)</span><br><span class="line"></span><br><span class="line">cm1 = confusion_matrix(y_test, predict_y)</span><br><span class="line">class_names = [<span class="string">&#x27;违约&#x27;</span>, <span class="string">&#x27;未违约&#x27;</span>]</span><br><span class="line"><span class="comment"># 显示混淆矩阵</span></span><br><span class="line">plot_confusion_matrix(cm1, classes=class_names, title=<span class="string">&#x27;决策树分类&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Confusion_matrix(dt)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 决策树分类器</span></span><br><span class="line">dt.fit(X_train, y_train)</span><br><span class="line">predict_y = dt.predict(X_test)</span><br><span class="line"></span><br><span class="line">cm1 = confusion_matrix(y_test, predict_y)</span><br><span class="line">class_names = [<span class="string">&#x27;违约&#x27;</span>, <span class="string">&#x27;未违约&#x27;</span>]</span><br><span class="line"><span class="comment"># 显示混淆矩阵</span></span><br><span class="line">plot_confusion_matrix(cm1, classes=class_names, title=<span class="string">&#x27;决策树分类&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Confusion_matrix(dt)</span><br></pre></td></tr></table></figure>

<p>决策树分类器 混淆矩阵：</p>
<img src="/posts/c1c7733e/5.png" class="">

<p>决策树分类器 分类报告：</p>
<img src="/posts/c1c7733e/6.png" class="">

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 决策树弱分类器</span></span><br><span class="line"><span class="comment">#dt_stump = DecisionTreeClassifier()</span></span><br><span class="line">dt_stump.fit(X_train, y_train)</span><br><span class="line">predict_y = dt_stump.predict(X_test)</span><br><span class="line"><span class="comment">#score_y = dt_stump.decision_function(X_test)</span></span><br><span class="line">cm1 = confusion_matrix(y_test, predict_y)</span><br><span class="line">class_names = [<span class="string">&#x27;违约&#x27;</span>, <span class="string">&#x27;未违约&#x27;</span>]</span><br><span class="line"><span class="comment"># 显示混淆矩阵</span></span><br><span class="line">plot_confusion_matrix(cm1, classes=class_names, title=<span class="string">&#x27;决策树弱分类&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Confusion_matrix(dt_stump)</span><br></pre></td></tr></table></figure>

<p>决策树弱分类器 混淆矩阵：</p>
<img src="/posts/c1c7733e/7.png" class="">

<p>决策树弱分类器 分类报告：</p>
<img src="/posts/c1c7733e/8.png" class="">

<h3 id="AdaBoost"><a href="#AdaBoost" class="headerlink" title="AdaBoost"></a>AdaBoost</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#AdaBoost分类器 基分类器提升（循环）次数,随机种子设置,</span></span><br><span class="line">ada = AdaBoostClassifier(n_estimators = <span class="number">10</span>,random_state = <span class="number">10</span>,learning_rate=<span class="number">1.1</span>)</span><br><span class="line">ada.fit(features_train,train_label)</span><br><span class="line"></span><br><span class="line">ada.fit(X_train, y_train)</span><br><span class="line">predict_y = ada.predict(X_test)</span><br><span class="line"></span><br><span class="line">cm2 = confusion_matrix(y_test, predict_y)</span><br><span class="line"></span><br><span class="line">class_names = [<span class="string">&#x27;违约&#x27;</span>, <span class="string">&#x27;未违约&#x27;</span>]</span><br><span class="line"><span class="comment"># 显示混淆矩阵</span></span><br><span class="line">plot_confusion_matrix(cm2, classes=class_names, title=<span class="string">&#x27;AdaBoost分类器&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Confusion_matrix(ada)</span><br></pre></td></tr></table></figure>

<p>AdaBoost分类器 混淆矩阵：</p>
<img src="/posts/c1c7733e/9.png" class="">

<p>AdaBoost分类器 分类报告：</p>
<img src="/posts/c1c7733e/10.png" class="">

<h3 id="XGBoost"><a href="#XGBoost" class="headerlink" title="XGBoost"></a>XGBoost</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#XGBoost分类器</span></span><br><span class="line"><span class="comment">#xgb = XGBClassifier(n_estimators = 350, learning_rate=0.2)</span></span><br><span class="line">xgb = XGBClassifier()</span><br><span class="line">xgb.fit(features_train,train_label)</span><br><span class="line"></span><br><span class="line">xgb.fit(X_train, y_train)</span><br><span class="line">predict_y = xgb.predict(X_test)</span><br><span class="line"><span class="comment">#score_y = dt_stump.decision_function(X_test)</span></span><br><span class="line">cm3 = confusion_matrix(y_test, predict_y)</span><br><span class="line">class_names = [<span class="string">&#x27;违约&#x27;</span>, <span class="string">&#x27;未违约&#x27;</span>]</span><br><span class="line"><span class="comment"># 显示混淆矩阵</span></span><br><span class="line">plot_confusion_matrix(cm3, classes=class_names, title=<span class="string">&#x27;XGBoost分类器&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Confusion_matrix(xgb)</span><br></pre></td></tr></table></figure>

<p>XGBoost分类器 混淆矩阵：</p>
<img src="/posts/c1c7733e/11.png" class="">

<p>XGBoost分类器 分类报告：</p>
<img src="/posts/c1c7733e/12.png" class="">

<h3 id="逻辑回归"><a href="#逻辑回归" class="headerlink" title="逻辑回归"></a>逻辑回归</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 逻辑回归分类器</span></span><br><span class="line">log = LogisticRegression()</span><br><span class="line">log.fit(features_train, train_label)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逻辑回归分类器</span></span><br><span class="line">log = LogisticRegression()</span><br><span class="line">log.fit(X_train, y_train)</span><br><span class="line">predict_y = log.predict(X_test)</span><br><span class="line">score_y = log.decision_function(X_test)</span><br><span class="line">cm = confusion_matrix(y_test, predict_y)</span><br><span class="line">class_names = [<span class="string">&#x27;违约&#x27;</span>, <span class="string">&#x27;未违约&#x27;</span>]</span><br><span class="line"><span class="comment"># 显示混淆矩阵</span></span><br><span class="line">plot_confusion_matrix(cm, classes=class_names, title=<span class="string">&#x27;逻辑回归&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Confusion_matrix(log)</span><br></pre></td></tr></table></figure>

<p>逻辑回归 混淆矩阵：</p>
<img src="/posts/c1c7733e/13.png" class="">

<p>逻辑回归 分类报告：</p>
<img src="/posts/c1c7733e/14.png" class="">

<h3 id="朴素贝叶斯"><a href="#朴素贝叶斯" class="headerlink" title="朴素贝叶斯"></a>朴素贝叶斯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多项朴素贝叶斯分类器</span></span><br><span class="line">mul = MultinomialNB()</span><br><span class="line"><span class="comment">#mul.fit(features_train, train_label)</span></span><br><span class="line">mul.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment">#mul.fit(X_train, y_train)</span></span><br><span class="line">predict_y = mul.predict(X_test)</span><br><span class="line"><span class="comment">#score_y = mul.decision_function(X_test)</span></span><br><span class="line">cm4 = confusion_matrix(y_test, predict_y)</span><br><span class="line">class_names = [<span class="string">&#x27;违约&#x27;</span>, <span class="string">&#x27;未违约&#x27;</span>]</span><br><span class="line"><span class="comment"># 显示混淆矩阵</span></span><br><span class="line">plot_confusion_matrix(cm4, classes=class_names, title=<span class="string">&#x27;多项朴素贝叶斯&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Confusion_matrix(mul)</span><br></pre></td></tr></table></figure>

<p>朴素贝叶斯 混淆矩阵：</p>
<img src="/posts/c1c7733e/15.png" class="">

<p>朴素贝叶斯 分类报告：</p>
<img src="/posts/c1c7733e/16.png" class="">

<h2 id="结果整合"><a href="#结果整合" class="headerlink" title="结果整合"></a>结果整合</h2><img src="/posts/c1c7733e/17.png" class="">

<hr>
<h1 id="GMM聚类"><a href="#GMM聚类" class="headerlink" title="GMM聚类"></a>GMM聚类</h1><p>EM算法处理王者荣耀英雄属性数据集</p>
<h2 id="使用EM算法工具完成聚类分析算法"><a href="#使用EM算法工具完成聚类分析算法" class="headerlink" title="使用EM算法工具完成聚类分析算法"></a>使用EM算法工具完成聚类分析算法</h2><p>实验目的： 学习使用EM算法工具完成聚类分析算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实验使用的工具包</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> sklearn.mixture <span class="keyword">import</span> GaussianMixture</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h3 id="数据读取"><a href="#数据读取" class="headerlink" title="数据读取"></a>数据读取</h3><p>任务一：数据加载，避免中文乱码问题完成</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据读取,请填写相应的代码！</span></span><br><span class="line">data_ori = pd.read_csv(<span class="string">&#x27;heros.csv&#x27;</span>, encoding=<span class="string">&#x27;gb18030&#x27;</span>)</span><br><span class="line">features = [<span class="string">u&#x27;最大生命&#x27;</span>,<span class="string">u&#x27;生命成长&#x27;</span>,<span class="string">u&#x27;初始生命&#x27;</span>,<span class="string">u&#x27;最大法力&#x27;</span>, <span class="string">u&#x27;法力成长&#x27;</span>,<span class="string">u&#x27;初始法力&#x27;</span>,<span class="string">u&#x27;最高物攻&#x27;</span>,<span class="string">u&#x27;物攻成长&#x27;</span>,<span class="string">u&#x27;初始物攻&#x27;</span>,<span class="string">u&#x27;最大物防&#x27;</span>,<span class="string">u&#x27;物防成长&#x27;</span>,<span class="string">u&#x27;初始物防&#x27;</span>, <span class="string">u&#x27;最大每5秒回血&#x27;</span>, <span class="string">u&#x27;每5秒回血成长&#x27;</span>, <span class="string">u&#x27;初始每5秒回血&#x27;</span>, <span class="string">u&#x27;最大每5秒回蓝&#x27;</span>, <span class="string">u&#x27;每5秒回蓝成长&#x27;</span>, <span class="string">u&#x27;初始每5秒回蓝&#x27;</span>, <span class="string">u&#x27;最大攻速&#x27;</span>, <span class="string">u&#x27;攻击范围&#x27;</span>]</span><br><span class="line">data = data_ori[features]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对英雄属性之间的关系进行可视化分析</span></span><br><span class="line"><span class="comment"># 设置 plt 正确显示中文</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment"># 用来正常显示中文标签</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]=<span class="literal">False</span> <span class="comment"># 用来正常显示负号</span></span><br></pre></td></tr></table></figure>

<h3 id="数据探索-2"><a href="#数据探索-2" class="headerlink" title="数据探索"></a>数据探索</h3><p>任务二：编写计算特征之间相似度的代码</p>
<p>用热力图呈现 features_mean 字段之间的相关性 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#填写相应代码！！</span></span><br><span class="line">corr = data[features].corr()</span><br><span class="line"><span class="built_in">print</span>(corr)</span><br><span class="line">             最大生命      生命成长      初始生命      最大法力      法力成长      初始法力      最高物攻  \</span><br><span class="line">最大生命     <span class="number">1.000000</span>  <span class="number">0.977408</span>  <span class="number">0.761300</span> -<span class="number">0.220133</span> -<span class="number">0.207130</span> -<span class="number">0.260449</span> -<span class="number">0.246412</span>   </span><br><span class="line">生命成长     <span class="number">0.977408</span>  <span class="number">1.000000</span>  <span class="number">0.658106</span> -<span class="number">0.224112</span> -<span class="number">0.212271</span> -<span class="number">0.260464</span> -<span class="number">0.268377</span>   </span><br><span class="line">初始生命     <span class="number">0.761300</span>  <span class="number">0.658106</span>  <span class="number">1.000000</span> -<span class="number">0.189349</span> -<span class="number">0.178674</span> -<span class="number">0.222314</span> -<span class="number">0.140356</span>   </span><br><span class="line">最大法力    -<span class="number">0.220133</span> -<span class="number">0.224112</span> -<span class="number">0.189349</span>  <span class="number">1.000000</span>  <span class="number">0.998958</span>  <span class="number">0.988178</span> -<span class="number">0.180428</span>   </span><br><span class="line">法力成长    -<span class="number">0.207130</span> -<span class="number">0.212271</span> -<span class="number">0.178674</span>  <span class="number">0.998958</span>  <span class="number">1.000000</span>  <span class="number">0.980154</span> -<span class="number">0.175029</span>   </span><br><span class="line">初始法力    -<span class="number">0.260449</span> -<span class="number">0.260464</span> -<span class="number">0.222314</span>  <span class="number">0.988178</span>  <span class="number">0.980154</span>  <span class="number">1.000000</span> -<span class="number">0.195800</span>   </span><br><span class="line">最高物攻    -<span class="number">0.246412</span> -<span class="number">0.268377</span> -<span class="number">0.140356</span> -<span class="number">0.180428</span> -<span class="number">0.175029</span> -<span class="number">0.195800</span>  <span class="number">1.000000</span>   </span><br><span class="line">物攻成长    -<span class="number">0.230507</span> -<span class="number">0.248988</span> -<span class="number">0.121609</span> -<span class="number">0.197617</span> -<span class="number">0.191883</span> -<span class="number">0.213851</span>  <span class="number">0.986098</span>   </span><br><span class="line">初始物攻    -<span class="number">0.195840</span> -<span class="number">0.223728</span> -<span class="number">0.161278</span>  <span class="number">0.003153</span>  <span class="number">0.003966</span>  <span class="number">0.000371</span>  <span class="number">0.536409</span>   </span><br><span class="line">最大物防     <span class="number">0.862472</span>  <span class="number">0.879106</span>  <span class="number">0.529737</span> -<span class="number">0.210425</span> -<span class="number">0.200722</span> -<span class="number">0.239802</span> -<span class="number">0.227352</span>   </span><br><span class="line">物防成长     <span class="number">0.832795</span>  <span class="number">0.847654</span>  <span class="number">0.528719</span> -<span class="number">0.226732</span> -<span class="number">0.217018</span> -<span class="number">0.255893</span> -<span class="number">0.182300</span>   </span><br><span class="line">初始物防     <span class="number">0.746460</span>  <span class="number">0.764736</span>  <span class="number">0.403032</span> -<span class="number">0.106082</span> -<span class="number">0.098780</span> -<span class="number">0.128992</span> -<span class="number">0.316263</span>   </span><br><span class="line">最大每<span class="number">5</span>秒回血  <span class="number">0.951013</span>  <span class="number">0.943635</span>  <span class="number">0.688104</span> -<span class="number">0.224234</span> -<span class="number">0.212305</span> -<span class="number">0.260875</span> -<span class="number">0.290216</span>   </span><br><span class="line">每<span class="number">5</span>秒回血成长  <span class="number">0.967369</span>  <span class="number">0.972436</span>  <span class="number">0.647438</span> -<span class="number">0.190258</span> -<span class="number">0.177943</span> -<span class="number">0.228721</span> -<span class="number">0.246922</span>   </span><br><span class="line">初始每<span class="number">5</span>秒回血  <span class="number">0.829468</span>  <span class="number">0.798746</span>  <span class="number">0.701547</span> -<span class="number">0.268561</span> -<span class="number">0.258510</span> -<span class="number">0.298217</span> -<span class="number">0.346468</span>   </span><br><span class="line">最大每<span class="number">5</span>秒回蓝 -<span class="number">0.286851</span> -<span class="number">0.297569</span> -<span class="number">0.224674</span>  <span class="number">0.872025</span>  <span class="number">0.853143</span>  <span class="number">0.922108</span> -<span class="number">0.193140</span>   </span><br><span class="line">每<span class="number">5</span>秒回蓝成长 -<span class="number">0.207165</span> -<span class="number">0.212225</span> -<span class="number">0.179819</span>  <span class="number">0.996253</span>  <span class="number">0.997483</span>  <span class="number">0.976856</span> -<span class="number">0.179123</span>   </span><br><span class="line">初始每<span class="number">5</span>秒回蓝 -<span class="number">0.279098</span> -<span class="number">0.292439</span> -<span class="number">0.199537</span>  <span class="number">0.450477</span>  <span class="number">0.415945</span>  <span class="number">0.559600</span> -<span class="number">0.145060</span>   </span><br><span class="line"></span><br><span class="line">             物攻成长      初始物攻      最大物防      物防成长      初始物防   最大每<span class="number">5</span>秒回血   每<span class="number">5</span>秒回血成长  \</span><br><span class="line">最大生命    -<span class="number">0.230507</span> -<span class="number">0.195840</span>  <span class="number">0.862472</span>  <span class="number">0.832795</span>  <span class="number">0.746460</span>  <span class="number">0.951013</span>  <span class="number">0.967369</span>   </span><br><span class="line">生命成长    -<span class="number">0.248988</span> -<span class="number">0.223728</span>  <span class="number">0.879106</span>  <span class="number">0.847654</span>  <span class="number">0.764736</span>  <span class="number">0.943635</span>  <span class="number">0.972436</span>   </span><br><span class="line">初始生命    -<span class="number">0.121609</span> -<span class="number">0.161278</span>  <span class="number">0.529737</span>  <span class="number">0.528719</span>  <span class="number">0.403032</span>  <span class="number">0.688104</span>  <span class="number">0.647438</span>   </span><br><span class="line">最大法力    -<span class="number">0.197617</span>  <span class="number">0.003153</span> -<span class="number">0.210425</span> -<span class="number">0.226732</span> -<span class="number">0.106082</span> -<span class="number">0.224234</span> -<span class="number">0.190258</span>   </span><br><span class="line">法力成长    -<span class="number">0.191883</span>  <span class="number">0.003966</span> -<span class="number">0.200722</span> -<span class="number">0.217018</span> -<span class="number">0.098780</span> -<span class="number">0.212305</span> -<span class="number">0.177943</span>   </span><br><span class="line">初始法力    -<span class="number">0.213851</span>  <span class="number">0.000371</span> -<span class="number">0.239802</span> -<span class="number">0.255893</span> -<span class="number">0.128992</span> -<span class="number">0.260875</span> -<span class="number">0.228721</span>   </span><br><span class="line">最高物攻     <span class="number">0.986098</span>  <span class="number">0.536409</span> -<span class="number">0.227352</span> -<span class="number">0.182300</span> -<span class="number">0.316263</span> -<span class="number">0.290216</span> -<span class="number">0.246922</span>   </span><br><span class="line">物攻成长     <span class="number">1.000000</span>  <span class="number">0.388718</span> -<span class="number">0.218394</span> -<span class="number">0.170773</span> -<span class="number">0.317801</span> -<span class="number">0.276067</span> -<span class="number">0.231988</span>   </span><br><span class="line">初始物攻     <span class="number">0.388718</span>  <span class="number">1.000000</span> -<span class="number">0.151566</span> -<span class="number">0.143719</span> -<span class="number">0.139327</span> -<span class="number">0.207319</span> -<span class="number">0.191102</span>   </span><br><span class="line">最大物防    -<span class="number">0.218394</span> -<span class="number">0.151566</span>  <span class="number">1.000000</span>  <span class="number">0.983223</span>  <span class="number">0.808768</span>  <span class="number">0.864672</span>  <span class="number">0.883474</span>   </span><br><span class="line">物防成长    -<span class="number">0.170773</span> -<span class="number">0.143719</span>  <span class="number">0.983223</span>  <span class="number">1.000000</span>  <span class="number">0.687920</span>  <span class="number">0.836301</span>  <span class="number">0.849445</span>   </span><br><span class="line">初始物防    -<span class="number">0.317801</span> -<span class="number">0.139327</span>  <span class="number">0.808768</span>  <span class="number">0.687920</span>  <span class="number">1.000000</span>  <span class="number">0.743957</span>  <span class="number">0.776385</span>   </span><br><span class="line">最大每<span class="number">5</span>秒回血 -<span class="number">0.276067</span> -<span class="number">0.207319</span>  <span class="number">0.864672</span>  <span class="number">0.836301</span>  <span class="number">0.743957</span>  <span class="number">1.000000</span>  <span class="number">0.983556</span>   </span><br><span class="line">每<span class="number">5</span>秒回血成长 -<span class="number">0.231988</span> -<span class="number">0.191102</span>  <span class="number">0.883474</span>  <span class="number">0.849445</span>  <span class="number">0.776385</span>  <span class="number">0.983556</span>  <span class="number">1.000000</span>   </span><br><span class="line">初始每<span class="number">5</span>秒回血 -<span class="number">0.335171</span> -<span class="number">0.219081</span>  <span class="number">0.746610</span>  <span class="number">0.731842</span>  <span class="number">0.611008</span>  <span class="number">0.937169</span>  <span class="number">0.858750</span>   </span><br><span class="line">最大每<span class="number">5</span>秒回蓝 -<span class="number">0.226294</span>  <span class="number">0.078473</span> -<span class="number">0.269346</span> -<span class="number">0.282500</span> -<span class="number">0.160954</span> -<span class="number">0.267749</span> -<span class="number">0.247764</span>   </span><br><span class="line">每<span class="number">5</span>秒回蓝成长 -<span class="number">0.196605</span>  <span class="number">0.005237</span> -<span class="number">0.202790</span> -<span class="number">0.217446</span> -<span class="number">0.105629</span> -<span class="number">0.202148</span> -<span class="number">0.169121</span>   </span><br><span class="line">初始每<span class="number">5</span>秒回蓝 -<span class="number">0.184345</span>  <span class="number">0.132174</span> -<span class="number">0.253111</span> -<span class="number">0.260324</span> -<span class="number">0.168099</span> -<span class="number">0.250934</span> -<span class="number">0.251700</span>   </span><br><span class="line"></span><br><span class="line">          初始每<span class="number">5</span>秒回血   最大每<span class="number">5</span>秒回蓝   每<span class="number">5</span>秒回蓝成长   初始每<span class="number">5</span>秒回蓝  </span><br><span class="line">最大生命     <span class="number">0.829468</span> -<span class="number">0.286851</span> -<span class="number">0.207165</span> -<span class="number">0.279098</span>  </span><br><span class="line">生命成长     <span class="number">0.798746</span> -<span class="number">0.297569</span> -<span class="number">0.212225</span> -<span class="number">0.292439</span>  </span><br><span class="line">初始生命     <span class="number">0.701547</span> -<span class="number">0.224674</span> -<span class="number">0.179819</span> -<span class="number">0.199537</span>  </span><br><span class="line">最大法力    -<span class="number">0.268561</span>  <span class="number">0.872025</span>  <span class="number">0.996253</span>  <span class="number">0.450477</span>  </span><br><span class="line">法力成长    -<span class="number">0.258510</span>  <span class="number">0.853143</span>  <span class="number">0.997483</span>  <span class="number">0.415945</span>  </span><br><span class="line">初始法力    -<span class="number">0.298217</span>  <span class="number">0.922108</span>  <span class="number">0.976856</span>  <span class="number">0.559600</span>  </span><br><span class="line">最高物攻    -<span class="number">0.346468</span> -<span class="number">0.193140</span> -<span class="number">0.179123</span> -<span class="number">0.145060</span>  </span><br><span class="line">物攻成长    -<span class="number">0.335171</span> -<span class="number">0.226294</span> -<span class="number">0.196605</span> -<span class="number">0.184345</span>  </span><br><span class="line">初始物攻    -<span class="number">0.219081</span>  <span class="number">0.078473</span>  <span class="number">0.005237</span>  <span class="number">0.132174</span>  </span><br><span class="line">最大物防     <span class="number">0.746610</span> -<span class="number">0.269346</span> -<span class="number">0.202790</span> -<span class="number">0.253111</span>  </span><br><span class="line">物防成长     <span class="number">0.731842</span> -<span class="number">0.282500</span> -<span class="number">0.217446</span> -<span class="number">0.260324</span>  </span><br><span class="line">初始物防     <span class="number">0.611008</span> -<span class="number">0.160954</span> -<span class="number">0.105629</span> -<span class="number">0.168099</span>  </span><br><span class="line">最大每<span class="number">5</span>秒回血  <span class="number">0.937169</span> -<span class="number">0.267749</span> -<span class="number">0.202148</span> -<span class="number">0.250934</span>  </span><br><span class="line">每<span class="number">5</span>秒回血成长  <span class="number">0.858750</span> -<span class="number">0.247764</span> -<span class="number">0.169121</span> -<span class="number">0.251700</span>  </span><br><span class="line">初始每<span class="number">5</span>秒回血  <span class="number">1.000000</span> -<span class="number">0.280945</span> -<span class="number">0.246737</span> -<span class="number">0.225670</span>  </span><br><span class="line">最大每<span class="number">5</span>秒回蓝 -<span class="number">0.280945</span>  <span class="number">1.000000</span>  <span class="number">0.856248</span>  <span class="number">0.827604</span>  </span><br><span class="line">每<span class="number">5</span>秒回蓝成长 -<span class="number">0.246737</span>  <span class="number">0.856248</span>  <span class="number">1.000000</span>  <span class="number">0.418679</span>  </span><br><span class="line">初始每<span class="number">5</span>秒回蓝 -<span class="number">0.225670</span>  <span class="number">0.827604</span>  <span class="number">0.418679</span>  <span class="number">1.000000</span>  </span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#热力图可视化！！</span></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>,<span class="number">14</span>))</span><br><span class="line"><span class="comment"># annot=True 显示每个方格的数据</span></span><br><span class="line">sns.heatmap(corr, annot=<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<img src="/posts/c1c7733e/GMM.png" class="">

<p>从图中可以看出“最大生命”，“生命成长”，“初始生命”这三个属性的相关性大，我们只 需保留一个属性即可。 features_remain数组保留了特征选择的属性，这样将原本的20个属性降维到了13个属性。 相关性大cong的属性保留一个，因此可以对属性进行降维</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将原本的20个属性降维到13个属性。请填写代码！</span></span><br><span class="line">features = [<span class="string">u&#x27;最大生命&#x27;</span>,<span class="string">u&#x27;生命成长&#x27;</span>,<span class="string">u&#x27;初始生命&#x27;</span>,<span class="string">u&#x27;最大法力&#x27;</span>, <span class="string">u&#x27;法力成长&#x27;</span>,<span class="string">u&#x27;初始法力&#x27;</span>,<span class="string">u&#x27;最高物攻&#x27;</span>,<span class="string">u&#x27;物攻成长&#x27;</span>,<span class="string">u&#x27;初始物攻&#x27;</span>,<span class="string">u&#x27;最大物防&#x27;</span>,<span class="string">u&#x27;物防成长&#x27;</span>,<span class="string">u&#x27;初始物防&#x27;</span>, <span class="string">u&#x27;最大每5秒回血&#x27;</span>, <span class="string">u&#x27;每5秒回血成长&#x27;</span>, <span class="string">u&#x27;初始每5秒回血&#x27;</span>, <span class="string">u&#x27;最大每5秒回蓝&#x27;</span>, <span class="string">u&#x27;每5秒回蓝成长&#x27;</span>, <span class="string">u&#x27;初始每5秒回蓝&#x27;</span>, <span class="string">u&#x27;最大攻速&#x27;</span>, <span class="string">u&#x27;攻击范围&#x27;</span>]</span><br><span class="line">data = data_ori[features]</span><br></pre></td></tr></table></figure>

<h3 id="数据清洗-1"><a href="#数据清洗-1" class="headerlink" title="数据清洗"></a>数据清洗</h3><p>任务三： “最大攻速”这个属性值是百分数，不适合做矩阵运算，需要将百分数转化成小数。 “攻击范围”这个字段的取值为远程或者近战，也不适合矩阵运算； </p>
<p>解决办法：将取值做个映射，用1代表远程，0代表近战。 </p>
<p>示例：map({‘远程’:1,’近战’:0})</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">u&#x27;最大攻速&#x27;</span>] = data[<span class="string">u&#x27;最大攻速&#x27;</span>].apply(<span class="keyword">lambda</span> x:<span class="built_in">float</span>(x.strip(<span class="string">&#x27;%&#x27;</span>))/<span class="number">100</span>)</span><br><span class="line">data[<span class="string">u&#x27;攻击范围&#x27;</span>] = data[<span class="string">u&#x27;攻击范围&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="string">&#x27;远程&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;近战&#x27;</span>:<span class="number">0</span>&#125;)</span><br><span class="line">&lt;ipython-<span class="built_in">input</span>-<span class="number">73</span>-cb0648147d53&gt;:<span class="number">2</span>: SettingWithCopyWarning: </span><br><span class="line">A value <span class="keyword">is</span> trying to be <span class="built_in">set</span> on a copy of a <span class="built_in">slice</span> <span class="keyword">from</span> a DataFrame.</span><br><span class="line">Try using .loc[row_indexer,col_indexer] = value instead</span><br><span class="line"></span><br><span class="line">See the caveats <span class="keyword">in</span> the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html<span class="comment">#returning-a-view-versus-a-copy</span></span><br><span class="line">  data[<span class="string">u&#x27;最大攻速&#x27;</span>] = data[<span class="string">u&#x27;最大攻速&#x27;</span>].apply(<span class="keyword">lambda</span> x:<span class="built_in">float</span>(x.strip(<span class="string">&#x27;%&#x27;</span>))/<span class="number">100</span>)</span><br><span class="line">&lt;ipython-<span class="built_in">input</span>-<span class="number">73</span>-cb0648147d53&gt;:<span class="number">3</span>: SettingWithCopyWarning: </span><br><span class="line">A value <span class="keyword">is</span> trying to be <span class="built_in">set</span> on a copy of a <span class="built_in">slice</span> <span class="keyword">from</span> a DataFrame.</span><br><span class="line">Try using .loc[row_indexer,col_indexer] = value instead</span><br><span class="line"></span><br><span class="line">See the caveats <span class="keyword">in</span> the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html<span class="comment">#returning-a-view-versus-a-copy</span></span><br><span class="line">  data[<span class="string">u&#x27;攻击范围&#x27;</span>] = data[<span class="string">u&#x27;攻击范围&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="string">&#x27;远程&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;近战&#x27;</span>:<span class="number">0</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>采用 Z-Score 规范化数据，保证每个特征维度的数据均值为 0，方差为 1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ss = StandardScaler()</span><br><span class="line">data = ss.fit_transform(data)</span><br></pre></td></tr></table></figure>

<p>构造GMM聚类模型，GaussianMixture()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">gmm = GaussianMixture(n_components=<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练数据</span></span><br><span class="line">gmm.fit(data)</span><br><span class="line"></span><br><span class="line">prediction = gmm.predict(data)</span><br><span class="line"><span class="built_in">print</span>(prediction)</span><br><span class="line">[<span class="number">13</span> <span class="number">24</span> <span class="number">11</span> <span class="number">10</span>  <span class="number">2</span> <span class="number">25</span> <span class="number">20</span> <span class="number">11</span>  <span class="number">7</span> <span class="number">24</span> <span class="number">18</span> <span class="number">14</span> <span class="number">10</span>  <span class="number">0</span>  <span class="number">1</span> <span class="number">18</span> <span class="number">13</span>  <span class="number">7</span>  <span class="number">2</span> <span class="number">12</span> <span class="number">22</span> <span class="number">12</span> <span class="number">12</span> <span class="number">12</span></span><br><span class="line"> <span class="number">12</span> <span class="number">12</span> <span class="number">12</span> <span class="number">21</span> <span class="number">16</span> <span class="number">26</span> <span class="number">24</span>  <span class="number">9</span>  <span class="number">9</span> <span class="number">16</span> <span class="number">26</span>  <span class="number">9</span> <span class="number">16</span>  <span class="number">6</span>  <span class="number">4</span> <span class="number">15</span>  <span class="number">9</span> <span class="number">16</span> <span class="number">16</span>  <span class="number">9</span> <span class="number">16</span> <span class="number">15</span> <span class="number">14</span>  <span class="number">4</span></span><br><span class="line"> <span class="number">24</span> <span class="number">16</span> <span class="number">28</span>  <span class="number">5</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">3</span> <span class="number">13</span> <span class="number">29</span>  <span class="number">5</span> <span class="number">23</span>  <span class="number">2</span> <span class="number">29</span> <span class="number">19</span> <span class="number">17</span> <span class="number">13</span>  <span class="number">8</span>  <span class="number">5</span> <span class="number">27</span>  <span class="number">5</span> <span class="number">21</span>]</span><br><span class="line"> </span><br><span class="line"> <span class="comment"># 将分组结果输出到 CSV 文件中</span></span><br><span class="line">data_ori.insert(<span class="number">0</span>, <span class="string">&#x27;分组&#x27;</span>, prediction)</span><br><span class="line">data_ori.to_csv(<span class="string">&#x27;.hero_out.csv&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> calinski_harabasz_score</span><br><span class="line"><span class="built_in">print</span>(calinski_harabasz_score(data, prediction))</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="航空公司客户价值分析"><a href="#航空公司客户价值分析" class="headerlink" title="航空公司客户价值分析"></a>航空公司客户价值分析</h1><img src="/posts/c1c7733e/%E8%88%AA%E7%A9%BA.png" class="">

<hr>
<h1 id="比特币价格预测"><a href="#比特币价格预测" class="headerlink" title="比特币价格预测"></a>比特币价格预测</h1><p>比特币价格走势预测</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># 比特币走势预测，使用时间序列ARMA</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> statsmodels.tsa.arima_model <span class="keyword">import</span> ARMA</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据加载</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./bitcoin_2012-01-01_to_2018-10-31.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># 将时间作为df的索</span></span><br><span class="line">df.Timestamp = pd.to_datetime(df.Timestamp)</span><br><span class="line">df.index = df.Timestamp</span><br><span class="line"><span class="comment"># 数据探索</span></span><br><span class="line"><span class="built_in">print</span>(df.head(<span class="number">10</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">数据探索部分打印内容：</span><br><span class="line">            Timestamp      Open      High       Low     Close  Volume_(BTC)  \</span><br><span class="line">Timestamp                                                                     </span><br><span class="line"><span class="number">2011</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">2011</span>-<span class="number">12</span>-<span class="number">31</span>  <span class="number">4.465000</span>  <span class="number">4.482500</span>  <span class="number">4.465000</span>  <span class="number">4.482500</span>     <span class="number">23.829470</span>   </span><br><span class="line"><span class="number">2012</span>-01-01 <span class="number">2012</span>-01-01  <span class="number">4.806667</span>  <span class="number">4.806667</span>  <span class="number">4.806667</span>  <span class="number">4.806667</span>      <span class="number">7.200667</span>   </span><br><span class="line"><span class="number">2012</span>-01-02 <span class="number">2012</span>-01-02  <span class="number">5.000000</span>  <span class="number">5.000000</span>  <span class="number">5.000000</span>  <span class="number">5.000000</span>     <span class="number">19.048000</span>   </span><br><span class="line"><span class="number">2012</span>-01-03 <span class="number">2012</span>-01-03  <span class="number">5.252500</span>  <span class="number">5.252500</span>  <span class="number">5.252500</span>  <span class="number">5.252500</span>     <span class="number">11.004660</span>   </span><br><span class="line"><span class="number">2012</span>-01-04 <span class="number">2012</span>-01-04  <span class="number">5.200000</span>  <span class="number">5.223333</span>  <span class="number">5.200000</span>  <span class="number">5.223333</span>     <span class="number">11.914807</span>   </span><br><span class="line"><span class="number">2012</span>-01-05 <span class="number">2012</span>-01-05  <span class="number">6.281429</span>  <span class="number">6.286190</span>  <span class="number">6.281429</span>  <span class="number">6.286190</span>      <span class="number">4.514373</span>   </span><br><span class="line"><span class="number">2012</span>-01-06 <span class="number">2012</span>-01-06  <span class="number">6.435000</span>  <span class="number">6.445000</span>  <span class="number">6.435000</span>  <span class="number">6.445000</span>      <span class="number">2.420196</span>   </span><br><span class="line"><span class="number">2012</span>-01-07 <span class="number">2012</span>-01-07  <span class="number">6.800000</span>  <span class="number">6.800000</span>  <span class="number">6.800000</span>  <span class="number">6.800000</span>      <span class="number">0.295858</span>   </span><br><span class="line"><span class="number">2012</span>-01-08 <span class="number">2012</span>-01-08  <span class="number">6.950000</span>  <span class="number">6.950000</span>  <span class="number">6.950000</span>  <span class="number">6.950000</span>      <span class="number">2.500000</span>   </span><br><span class="line"><span class="number">2012</span>-01-09 <span class="number">2012</span>-01-09  <span class="number">6.584167</span>  <span class="number">6.584167</span>  <span class="number">6.581667</span>  <span class="number">6.581667</span>      <span class="number">1.857481</span>   </span><br><span class="line"></span><br><span class="line">            Volume_(Currency)  Weighted_Price  </span><br><span class="line">Timestamp                                      </span><br><span class="line"><span class="number">2011</span>-<span class="number">12</span>-<span class="number">31</span>         <span class="number">106.330084</span>        <span class="number">4.471603</span>  </span><br><span class="line"><span class="number">2012</span>-01-01          <span class="number">35.259720</span>        <span class="number">4.806667</span>  </span><br><span class="line"><span class="number">2012</span>-01-02          <span class="number">95.240000</span>        <span class="number">5.000000</span>  </span><br><span class="line"><span class="number">2012</span>-01-03          <span class="number">58.100651</span>        <span class="number">5.252500</span>  </span><br><span class="line"><span class="number">2012</span>-01-04          <span class="number">63.119578</span>        <span class="number">5.208159</span>  </span><br><span class="line"><span class="number">2012</span>-01-05          <span class="number">27.987370</span>        <span class="number">6.284127</span>  </span><br><span class="line"><span class="number">2012</span>-01-06          <span class="number">15.914658</span>        <span class="number">6.438999</span>  </span><br><span class="line"><span class="number">2012</span>-01-07           <span class="number">2.011834</span>        <span class="number">6.800000</span>  </span><br><span class="line"><span class="number">2012</span>-01-08          <span class="number">17.300000</span>        <span class="number">6.950000</span>  </span><br><span class="line"><span class="number">2012</span>-01-09          <span class="number">12.306798</span>        <span class="number">6.582770</span>  </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照月，季度，年来统计</span></span><br><span class="line">df_month = df.resample(<span class="string">&#x27;M&#x27;</span>).mean()</span><br><span class="line">df_Q = df.resample(<span class="string">&#x27;Q-DEC&#x27;</span>).mean()</span><br><span class="line">df_year = df.resample(<span class="string">&#x27;A-DEC&#x27;</span>).mean()</span><br><span class="line"><span class="comment"># 按照天，月，季度，年来显示比特币的走势</span></span><br><span class="line">fig = plt.figure(figsize=[<span class="number">15</span>, <span class="number">7</span>])</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">#用来正常显示中文标签</span></span><br><span class="line">plt.suptitle(<span class="string">&#x27;比特币金额（美金）&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">plt.subplot(<span class="number">221</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(df.Weighted_Price, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&#x27;按天&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.subplot(<span class="number">222</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(df.Weighted_Price, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&#x27;按月&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.subplot(<span class="number">223</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(df.Weighted_Price, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&#x27;按季度&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.subplot(<span class="number">224</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(df.Weighted_Price, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&#x27;按年&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>按照天、月、季度、年来统计显示比特币的走势：</p>
<img src="/posts/c1c7733e/bit1.png" class="">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置参数范围</span></span><br><span class="line">ps = <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">qs = <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">parameters = product(ps, qs)</span><br><span class="line">parameters_list = <span class="built_in">list</span>(parameters)</span><br><span class="line"><span class="comment"># 寻找最优ARMA模型参数，即best_aic最小</span></span><br><span class="line">results = []</span><br><span class="line">best_aic = <span class="built_in">float</span>(<span class="string">&quot;inf&quot;</span>) <span class="comment"># 正无穷</span></span><br><span class="line"><span class="keyword">for</span> param <span class="keyword">in</span> parameters_list:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        model = ARMA(df_month.Weighted_Price,order=(param[<span class="number">0</span>], param[<span class="number">1</span>])).fit()</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;参数错误:&#x27;</span>, param)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    aic = model.aic</span><br><span class="line">    <span class="keyword">if</span> aic &lt; best_aic:</span><br><span class="line">        best_model = model</span><br><span class="line">        best_aic = aic</span><br><span class="line">        best_param = param</span><br><span class="line">    results.append([param, model.aic])</span><br><span class="line"><span class="comment"># 输出最优模型</span></span><br><span class="line">result_table = pd.DataFrame(results)</span><br><span class="line">result_table.columns = [<span class="string">&#x27;parameters&#x27;</span>, <span class="string">&#x27;aic&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;最优模型:&#x27;</span>, best_model.summary())</span><br><span class="line"><span class="comment"># 比特币预测</span></span><br><span class="line">df_month2 = df_month[[<span class="string">&#x27;Weighted_Price&#x27;</span>]]</span><br><span class="line">date_list = [datetime(<span class="number">2018</span>, <span class="number">11</span>, <span class="number">30</span>), datetime(<span class="number">2018</span>, <span class="number">12</span>, <span class="number">31</span>), datetime(<span class="number">2019</span>, <span class="number">1</span>, <span class="number">31</span>),</span><br><span class="line">             datetime(<span class="number">2019</span>, <span class="number">2</span>, <span class="number">28</span>), datetime(<span class="number">2019</span>, <span class="number">3</span>, <span class="number">31</span>),</span><br><span class="line">             datetime(<span class="number">2019</span>, <span class="number">4</span>, <span class="number">30</span>), datetime(<span class="number">2019</span>, <span class="number">5</span>, <span class="number">31</span>), datetime(<span class="number">2019</span>, <span class="number">6</span>, <span class="number">30</span>)]</span><br><span class="line">future = pd.DataFrame(index=date_list, columns=df_month.columns)</span><br><span class="line">df_month2 = pd.concat([df_month2, future])</span><br><span class="line">df_month2[<span class="string">&#x27;forecast&#x27;</span>] = best_model.predict(start=<span class="number">0</span>, end=<span class="number">91</span>)</span><br><span class="line"><span class="comment"># 比特币预测结果显示</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">7</span>))</span><br><span class="line">df_month2.Weighted_Price.plot(label=<span class="string">&#x27;实际金额&#x27;</span>)</span><br><span class="line">df_month2.forecast.plot(color=<span class="string">&#x27;r&#x27;</span>, ls=<span class="string">&#x27;--&#x27;</span>, label=<span class="string">&#x27;预测金额&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.title(<span class="string">&#x27;比特币金额(月)&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;时间&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;美金&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<img src="/posts/c1c7733e/bit2.png" class="">

<p>比特币预测结果：</p>
<img src="/posts/c1c7733e/bit3.png" class="">

    </div>

    
    
    
        <div class="reward-container">
  <div>原创不易~蟹蟹老大~！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="STico 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="STico 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/6/" rel="tag"># 6</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/e39e2a4e.html" rel="prev" title="Python学习">
      <i class="fa fa-chevron-left"></i> Python学习
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/5f967442.html" rel="next" title="康博嘉-家">
      康博嘉-家 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Numpy%E5%AD%A6%E4%B9%A0"><span class="nav-number">1.</span> <span class="nav-text">Numpy学习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E5%85%B7%E4%BD%93%E8%A6%81%E6%B1%82"><span class="nav-number">1.1.</span> <span class="nav-text">题目具体要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Numpy%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">1.2.</span> <span class="nav-text">Numpy基本原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81"><span class="nav-number">1.3.</span> <span class="nav-text">实现代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C"><span class="nav-number">1.4.</span> <span class="nav-text">输出结果</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pandas%E5%AD%A6%E4%B9%A0"><span class="nav-number">2.</span> <span class="nav-text">Pandas学习</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Kaggle%E7%AB%9E%E8%B5%9B-Titanic%E4%B9%98%E5%AE%A2%E7%94%9F%E5%AD%98%E9%A2%84%E6%B5%8B"><span class="nav-number">3.</span> <span class="nav-text">Kaggle竞赛-Titanic乘客生存预测</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87%E4%BB%BB%E5%8A%A1"><span class="nav-number">3.1.</span> <span class="nav-text">目标任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE"><span class="nav-number">3.2.</span> <span class="nav-text">实验数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E5%AD%98%E9%A2%84%E6%B5%8B%E7%9A%84%E5%85%B3%E9%94%AE%E6%B5%81%E7%A8%8B"><span class="nav-number">3.3.</span> <span class="nav-text">生存预测的关键流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B"><span class="nav-number">3.4.</span> <span class="nav-text">实验过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97"><span class="nav-number">3.4.1.</span> <span class="nav-text">实验导入模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2"><span class="nav-number">3.4.2.</span> <span class="nav-text">数据探索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="nav-number">3.4.3.</span> <span class="nav-text">数据清洗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9"><span class="nav-number">3.4.4.</span> <span class="nav-text">特征选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E5%8F%8A%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AF%84%E4%BB%B7"><span class="nav-number">3.4.5.</span> <span class="nav-text">分类模型及模型的评价</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%84%E4%B8%AA%E5%88%86%E7%B1%BB%E5%99%A8%E5%87%86%E7%A1%AE%E7%8E%87"><span class="nav-number">3.4.6.</span> <span class="nav-text">各个分类器准确率</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%93%B6%E8%A1%8C%E5%AE%A2%E6%88%B7%E8%BF%9D%E7%BA%A6%E4%BF%A1%E7%94%A8%E5%88%86%E6%9E%90"><span class="nav-number">4.</span> <span class="nav-text">银行客户违约信用分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AF%BB%E5%8F%96%E8%BD%AC%E6%8D%A2csv%E6%96%87%E4%BB%B6%E9%A2%84%E5%A4%84%E7%90%86"><span class="nav-number">4.1.</span> <span class="nav-text">数据集读取转换csv文件预处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2-1"><span class="nav-number">4.2.</span> <span class="nav-text">数据探索</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E5%88%86%E7%B1%BB%E5%99%A8%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%9C%E5%91%88%E7%8E%B0"><span class="nav-number">4.3.</span> <span class="nav-text">不同分类器处理结果呈现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E4%B8%8E%E5%86%B3%E7%AD%96%E6%A0%91%E5%BC%B1%E5%88%86%E7%B1%BB%E5%99%A8"><span class="nav-number">4.3.1.</span> <span class="nav-text">决策树与决策树弱分类器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AdaBoost"><span class="nav-number">4.3.2.</span> <span class="nav-text">AdaBoost</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XGBoost"><span class="nav-number">4.3.3.</span> <span class="nav-text">XGBoost</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="nav-number">4.3.4.</span> <span class="nav-text">逻辑回归</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF"><span class="nav-number">4.3.5.</span> <span class="nav-text">朴素贝叶斯</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E6%9E%9C%E6%95%B4%E5%90%88"><span class="nav-number">4.4.</span> <span class="nav-text">结果整合</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GMM%E8%81%9A%E7%B1%BB"><span class="nav-number">5.</span> <span class="nav-text">GMM聚类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8EM%E7%AE%97%E6%B3%95%E5%B7%A5%E5%85%B7%E5%AE%8C%E6%88%90%E8%81%9A%E7%B1%BB%E5%88%86%E6%9E%90%E7%AE%97%E6%B3%95"><span class="nav-number">5.1.</span> <span class="nav-text">使用EM算法工具完成聚类分析算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96"><span class="nav-number">5.1.1.</span> <span class="nav-text">数据读取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2-2"><span class="nav-number">5.1.2.</span> <span class="nav-text">数据探索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97-1"><span class="nav-number">5.1.3.</span> <span class="nav-text">数据清洗</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%88%AA%E7%A9%BA%E5%85%AC%E5%8F%B8%E5%AE%A2%E6%88%B7%E4%BB%B7%E5%80%BC%E5%88%86%E6%9E%90"><span class="nav-number">6.</span> <span class="nav-text">航空公司客户价值分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E4%BB%B7%E6%A0%BC%E9%A2%84%E6%B5%8B"><span class="nav-number">7.</span> <span class="nav-text">比特币价格预测</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">STico</p>
  <div class="site-description" itemprop="description">永远相信美好的事情即将发生</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">STico</span>
</div>


        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<!-- 《页面点击小红心 -->
<% if (theme.love){ %>
    <script type="text/javascript" src="/js/love.js"></script>
<% } %>
<!-- 页面点击小红心》 -->

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"superSample":2,"width":200,"height":400,"position":"left","hOffset":0,"vOffset":-10},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body>
</html>